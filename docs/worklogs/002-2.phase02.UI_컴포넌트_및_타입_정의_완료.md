# 002-2.phase02.UI 컴포넌트 및 타입 정의 완료

**작업 일시**: 2025-10-28
**작업 단계**: Phase 02 - Step 2/3
**작업 상태**: ✅ 완료

---

## 작업 개요

마스터 데이터 CRUD UI 구현에 필요한 shadcn/ui 컴포넌트를 설치하고, Supabase 데이터베이스 스키마에 맞는 TypeScript 타입을 정의했습니다.

---

## 1. shadcn/ui 컴포넌트 설치

### 1.1 설치된 컴포넌트 (5개 + 훅)

| 컴포넌트 | 파일 | 용도 |
|---------|------|------|
| **table** | `components/ui/table.tsx` | 데이터 목록 표시 |
| **textarea** | `components/ui/textarea.tsx` | 긴 텍스트 입력 (Address, Notes) |
| **dialog** | `components/ui/dialog.tsx` | 모달 다이얼로그 (삭제 확인) |
| **select** | `components/ui/select.tsx` | 드롭다운 선택 (Unit, Category) |
| **toast** | `components/ui/toast.tsx` | 알림 메시지 |
| **toaster** | `components/ui/toaster.tsx` | Toast 컨테이너 |
| **use-toast** | `hooks/use-toast.ts` | Toast 훅 |

### 1.2 설치 명령어

```bash
npx shadcn@latest add table
npx shadcn@latest add textarea
npx shadcn@latest add dialog
npx shadcn@latest add select
npx shadcn@latest add toast
```

---

## 2. Toaster 설정

### 2.1 Root Layout 업데이트

**파일**: `app/layout.tsx`

**변경 사항**:
```typescript
import { Toaster } from "@/components/ui/toaster"

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body className={inter.className}>
        {children}
        <Toaster />  {/* 추가 */}
      </body>
    </html>
  )
}
```

### 2.2 Toaster 경로 수정

**파일**: `components/ui/toaster.tsx`

**수정**:
```typescript
// 변경 전
import { useToast } from "@/components/hooks/use-toast"

// 변경 후
import { useToast } from "@/hooks/use-toast"
```

**이유**: shadcn이 `hooks/` 폴더에 생성하므로 경로 수정 필요

---

## 3. TypeScript 타입 정의

### 3.1 Database 타입 파일 생성

**파일**: `types/database.ts` (신규)

**내용**:
- Supabase 데이터베이스 스키마 기반 TypeScript 타입
- 모든 테이블에 대한 `Row`, `Insert`, `Update` 타입 정의

**정의된 테이블**:
1. `locations` - 지사 정보
2. `suppliers` - 공급업체
3. `products` - 제품
4. `purchase_orders` - 구매 발주
5. `purchase_order_items` - 발주 상세
6. `stock_batches` - 재고 배치
7. `pricing_configs` - 가격 설정
8. `sales` - 판매 기록
9. `exchange_rates` - 환율

### 3.2 타입 별칭 추가

**파일**: `types/index.ts` (확장)

**추가된 타입**:
```typescript
// 기본 타입
export type Currency = 'KRW' | 'VND' | 'CNY'
export type POStatus = 'Draft' | 'Approved' | 'Received'
export type QualityStatus = 'OK' | 'Damaged' | 'Quarantine'
export type Unit = 'EA' | 'BOX' | 'PACK'

// 데이터베이스 테이블 타입 별칭
export type Location = Database['public']['Tables']['locations']['Row']
export type Supplier = Database['public']['Tables']['suppliers']['Row']
export type Product = Database['public']['Tables']['products']['Row']
// ... 기타 테이블

// Insert/Update 타입
export type LocationInsert = Database['public']['Tables']['locations']['Insert']
export type SupplierInsert = Database['public']['Tables']['suppliers']['Insert']
export type ProductInsert = Database['public']['Tables']['products']['Insert']
```

---

## 4. 상수 정의

### 4.1 lib/constants.ts 업데이트

**추가된 상수**:

#### 제품 단위 옵션
```typescript
export const PRODUCT_UNITS = [
  { value: 'EA', label: 'EA (Each)' },
  { value: 'BOX', label: 'BOX' },
  { value: 'PACK', label: 'PACK' },
] as const
```

#### 제품 카테고리 옵션
```typescript
export const PRODUCT_CATEGORIES = [
  { value: 'skincare', label: 'Skincare' },
  { value: 'makeup', label: 'Makeup' },
  { value: 'haircare', label: 'Haircare' },
  { value: 'bodycare', label: 'Bodycare' },
  { value: 'fragrance', label: 'Fragrance' },
] as const
```

#### 통화 기호 매핑
```typescript
export const CURRENCY_SYMBOLS: Record<Currency, string> = {
  KRW: '₩',
  VND: '₫',
  CNY: '¥',
}
```

#### 지사 타입 옵션
```typescript
export const LOCATION_TYPES = [
  { value: 'HQ', label: 'Headquarters' },
  { value: 'Branch', label: 'Branch' },
] as const
```

#### 통화 옵션
```typescript
export const CURRENCIES = [
  { value: 'KRW', label: 'KRW (₩)' },
  { value: 'VND', label: 'VND (₫)' },
  { value: 'CNY', label: 'CNY (¥)' },
] as const
```

### 4.2 네비게이션 메뉴 업데이트

**추가된 메뉴**:
```typescript
{
  title: "Locations",
  href: "/locations",
  icon: MapPin,
  roles: ["HQ_Admin"],
}
```

**메뉴 순서**:
1. Dashboard
2. **Locations** (신규)
3. Suppliers
4. Products
5. Purchase Orders
6. Inventory
7. Sales
8. Settings

---

## 5. 유틸리티 함수

### 5.1 lib/utils.ts 업데이트

#### 통화 포맷팅
```typescript
export function formatCurrency(amount: number, currency: Currency): string {
  const symbols: Record<Currency, string> = {
    KRW: '₩',
    VND: '₫',
    CNY: '¥',
  }

  const decimals = currency === 'CNY' ? 2 : 0

  return `${symbols[currency]}${amount.toLocaleString('en-US', {
    minimumFractionDigits: decimals,
    maximumFractionDigits: decimals,
  })}`
}
```

**예시**:
- `formatCurrency(5000, 'KRW')` → `₩5,000`
- `formatCurrency(18500, 'VND')` → `₫18,500`
- `formatCurrency(35.50, 'CNY')` → `¥35.50`

#### 날짜 포맷팅
```typescript
export function formatDate(date: string | Date): string {
  const d = typeof date === 'string' ? new Date(date) : date
  return d.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  })
}
```

**예시**:
- `formatDate('2025-10-28')` → `Oct 28, 2025`

#### SKU 유효성 검사
```typescript
export function isValidSKU(sku: string): boolean {
  // SKU: Only uppercase letters, numbers, and hyphens allowed
  return /^[A-Z0-9-]+$/.test(sku)
}
```

**예시**:
- `isValidSKU('PRD-001')` → `true`
- `isValidSKU('prd-001')` → `false` (소문자 불가)
- `isValidSKU('PRD_001')` → `false` (언더스코어 불가)

---

## 6. 검증

### 6.1 TypeScript 컴파일

**명령어**:
```bash
npx tsc --noEmit
```

**결과**: ✅ 오류 없음

### 6.2 Next.js 빌드

**명령어**:
```bash
npm run build
```

**결과**: ✅ 빌드 성공

**경고**:
- Supabase Edge Runtime 관련 경고 (기능에 영향 없음, Phase 01과 동일)

---

## 7. 완료 체크리스트

### 컴포넌트 설치
- [x] table 컴포넌트 설치
- [x] textarea 컴포넌트 설치
- [x] dialog 컴포넌트 설치
- [x] select 컴포넌트 설치
- [x] toast 컴포넌트 설치 (toast, toaster, use-toast)

### 설정
- [x] `app/layout.tsx`에 Toaster 추가
- [x] `components/ui/toaster.tsx` 경로 수정

### 타입 정의
- [x] `types/database.ts` 생성 (9개 테이블 타입)
- [x] `types/index.ts` 확장 (타입 별칭, 상수 타입)

### 상수 및 유틸리티
- [x] `lib/constants.ts` 업데이트 (PRODUCT_UNITS, PRODUCT_CATEGORIES, etc.)
- [x] `lib/constants.ts` 네비게이션에 Locations 추가
- [x] `lib/utils.ts` 업데이트 (formatCurrency, formatDate, isValidSKU)

### 검증
- [x] TypeScript 컴파일 성공
- [x] Next.js 빌드 성공

---

## 8. 생성/수정된 파일 목록

### 신규 파일 (8개)
1. `components/ui/table.tsx`
2. `components/ui/textarea.tsx`
3. `components/ui/dialog.tsx`
4. `components/ui/select.tsx`
5. `components/ui/toast.tsx`
6. `components/ui/toaster.tsx`
7. `hooks/use-toast.ts`
8. `types/database.ts`

### 수정 파일 (4개)
1. `app/layout.tsx` - Toaster 추가
2. `types/index.ts` - 타입 별칭 및 상수 타입 추가
3. `lib/constants.ts` - 제품/지사 상수, 네비게이션 업데이트
4. `lib/utils.ts` - 유틸리티 함수 추가

---

## 9. 사용 예시

### Toast 알림
```typescript
import { useToast } from '@/hooks/use-toast'

function MyComponent() {
  const { toast } = useToast()

  const handleSuccess = () => {
    toast({
      title: "Success",
      description: "Supplier created successfully",
    })
  }

  const handleError = () => {
    toast({
      variant: "destructive",
      title: "Error",
      description: "Failed to create supplier",
    })
  }
}
```

### Table 컴포넌트
```typescript
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table'

<Table>
  <TableHeader>
    <TableRow>
      <TableHead>Name</TableHead>
      <TableHead>Email</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    {data.map((item) => (
      <TableRow key={item.id}>
        <TableCell>{item.name}</TableCell>
        <TableCell>{item.email}</TableCell>
      </TableRow>
    ))}
  </TableBody>
</Table>
```

### Select 컴포넌트
```typescript
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'
import { PRODUCT_UNITS } from '@/lib/constants'

<Select value={unit} onValueChange={setUnit}>
  <SelectTrigger>
    <SelectValue placeholder="Select unit" />
  </SelectTrigger>
  <SelectContent>
    {PRODUCT_UNITS.map((unit) => (
      <SelectItem key={unit.value} value={unit.value}>
        {unit.label}
      </SelectItem>
    ))}
  </SelectContent>
</Select>
```

---

## 10. 다음 단계

Step 2 완료 후 **002-3.phase02.마스터_데이터_CRUD_구현**로 진행합니다.

**필요 작업**:
1. Locations 관리 UI 구현 (읽기 전용 중심)
2. Suppliers 관리 UI 구현 (전체 CRUD)
3. Products 관리 UI 구현 (전체 CRUD + SKU 중복 체크)

---

**작성자**: Claude Code
**작성일**: 2025-10-28
**다음 Step**: 002-3 (마스터 데이터 CRUD 구현)
