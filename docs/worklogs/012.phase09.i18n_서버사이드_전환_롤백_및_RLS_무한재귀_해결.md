# Worklog 012: Phase 09 i18n ì„œë²„ ì‚¬ì´ë“œ ì „í™˜ ë¡¤ë°± ë° RLS ë¬´í•œ ì¬ê·€ ë¬¸ì œ í•´ê²°

**ì‘ì—… ì¼ì:** 2025-10-31
**Phase:** 09 (Rollback & Fix)
**ì‘ì—…ì:** Claude AI Assistant
**ì†Œìš” ì‹œê°„:** ì•½ 4ì‹œê°„

---

## ğŸ“‹ ì‘ì—… ê°œìš”

Phase 09ì—ì„œ ì‹œë„í–ˆë˜ i18n ì„œë²„ ì‚¬ì´ë“œ ì „í™˜ì´ React Hydration ì—ëŸ¬ë¥¼ ì§€ì†ì ìœ¼ë¡œ ë°œìƒì‹œì¼œ **ì™„ì „ ë¡¤ë°±**ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. ë¡¤ë°± ê³¼ì •ì—ì„œ ë°œê²¬ëœ **users í…Œì´ë¸” RLS ë¬´í•œ ì¬ê·€ ë¬¸ì œ**ë¥¼ í•¨ê»˜ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

---

## ğŸ¯ ì‘ì—… ëª©í‘œ

1. âœ… Phase 09 i18n ì„œë²„ ì‚¬ì´ë“œ ì „í™˜ ì™„ì „ ë¡¤ë°±
2. âœ… í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ i18n êµ¬ì¡°ë¡œ ë³µì›
3. âœ… users í…Œì´ë¸” RLS ì •ì±… ë¬´í•œ ì¬ê·€ ë¬¸ì œ í•´ê²°
4. âœ… ë¡œê·¸ì¸ í›„ ëŒ€ì‹œë³´ë“œ ì ‘ê·¼ ë¶ˆê°€ ë¬¸ì œ í•´ê²°

---

## ğŸ” ë¬¸ì œ ìƒí™©

### 1. Phase 09 ì„œë²„ ì‚¬ì´ë“œ ì „í™˜ì˜ ë¬¸ì œì 

#### ë°œìƒí•œ ì—ëŸ¬ë“¤:
```
HierarchyRequestError: Failed to execute 'appendChild' on 'Node':
Only one element on document allowed.

NotFoundError: Failed to execute 'removeChild' on 'Node':
The node to be removed is not a child of this node.
```

#### ì‹œë„í•œ í•´ê²°ì±…ë“¤ (ëª¨ë‘ ì‹¤íŒ¨):
1. `suppressHydrationWarning` ì†ì„± ì¶”ê°€
2. `<head />` íƒœê·¸ ëª…ì‹œì  ì¶”ê°€
3. `app/[locale]/page.tsx`ì—ì„œ `null` ëŒ€ì‹  `<div />` ë°˜í™˜
4. Middleware redirect passthrough ìˆ˜ì •
5. Locale root í˜ì´ì§€ ìµœì†Œí™”

#### ê²°ë¡ :
- ê³„ì†ëœ hydration ì—ëŸ¬ ë°œìƒ
- `/ko/dashboard/dashboard` ê°™ì€ ì¤‘ë³µ redirect ë¬¸ì œ
- Productionì—ì„œ í™”ë©´ì´ ì•„ë¬´ê²ƒë„ í‘œì‹œë˜ì§€ ì•ŠìŒ
- **ê·¼ë³¸ì ì¸ ì•„í‚¤í…ì²˜ ë¬¸ì œë¡œ íŒë‹¨, ë¡¤ë°± ê²°ì •**

### 2. ë¡¤ë°± í›„ ë°œê²¬ëœ RLS ë¬´í•œ ì¬ê·€ ë¬¸ì œ

ë¡¤ë°± ì™„ë£Œ í›„ ë¡œê·¸ì¸ ì‹œë„ ì‹œ ìƒˆë¡œìš´ ë¬¸ì œ ë°œê²¬:

```
[DASHBOARD LAYOUT] Error: {
  code: '42P17',
  message: 'infinite recursion detected in policy for relation "users"'
}
```

**ì¦ìƒ:**
- ë¡œê·¸ì¸ì€ ì„±ê³µí•˜ì§€ë§Œ dashboardë¡œ ì´ë™ ë¶ˆê°€
- ê³„ì† `/login`ìœ¼ë¡œ redirectë¨
- user dataë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í•¨

**ì›ì¸:**
```sql
CREATE POLICY "HQ_Admin can view all users"
  ON public.users
  FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM public.users  -- â† ë¬´í•œ ì¬ê·€ ë°œìƒ!
      WHERE id = auth.uid() AND role = 'HQ_Admin'
    )
  );
```

ì •ì±… ë‚´ì—ì„œ `users` í…Œì´ë¸”ì„ ì¡°íšŒí•˜ë©´, ê·¸ ì¡°íšŒì—ì„œ ë˜ ê°™ì€ ì •ì±…ì´ ì‹¤í–‰ë˜ëŠ” ë¬´í•œ ì¬ê·€ ë°œìƒ.

---

## ğŸ› ï¸ ì‘ì—… ë‚´ìš©

### Part 1: Phase 09 ì™„ì „ ë¡¤ë°±

#### 1.1 ë°±ì—… ë¸Œëœì¹˜ ìƒì„±
```bash
git branch backup-phase09-20251031
```

**ì»¤ë°‹ ì´ë ¥ í™•ì¸:**
- `8700ae8` - Phase 09 ì‹œì‘ (ê³„íšì„œ ì‘ì„±)
- `9565f2d` - Phase 09 ì´ì „ (ë¡¤ë°± ëª©í‘œ ì§€ì )

#### 1.2 Hard Reset ì‹¤í–‰
```bash
git reset --hard 9565f2d
```

**ë³µì›ëœ êµ¬ì¡°:**
```
app/
â”œâ”€â”€ layout.tsx                 âœ… í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ i18n
â”œâ”€â”€ page.tsx                   âœ… locale ì—†ëŠ” URL
â”œâ”€â”€ (auth)/
â”‚   â””â”€â”€ login/                 âœ… ì›ë˜ ìœ„ì¹˜
â”œâ”€â”€ (dashboard)/               âœ… ì›ë˜ ìœ„ì¹˜
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â””â”€â”€ ...
â”‚
lib/
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ language-context.tsx   âœ… í´ë¼ì´ì–¸íŠ¸ ë©”ì‹œì§€ ë¡œë”©
â”œâ”€â”€ providers/
â”‚   â””â”€â”€ intl-provider.tsx      âœ… IntlProvider ì¡´ì¬
â”‚
middleware.ts                  âœ… Supabaseë§Œ ì²˜ë¦¬ (next-intl ì—†ìŒ)
```

**ì œê±°ëœ êµ¬ì¡°:**
- âŒ `app/[locale]/` í´ë” ì „ì²´
- âŒ `app/[locale]/layout.tsx`
- âŒ `app/[locale]/page.tsx`
- âŒ `app/[locale]/(auth)/`
- âŒ `app/[locale]/(dashboard)/`

#### 1.3 ë¡œì»¬ ë¹Œë“œ í™•ì¸
```bash
npm run build
```

**ê²°ê³¼:**
- âœ… ë¹Œë“œ ì„±ê³µ (29ê°œ í˜ì´ì§€ ìƒì„±)
- âš ï¸ ê²½ê³  ìˆì§€ë§Œ ì •ìƒ ì‘ë™
- ê²½ë¡œ: `/login`, `/dashboard` (locale prefix ì—†ìŒ)

#### 1.4 Force Push
```bash
git push origin master --force
```

**ê²°ê³¼:**
- Phase 09ì˜ ëª¨ë“  ì»¤ë°‹ ì œê±°
- `9565f2d` ìƒíƒœë¡œ ë³µì›
- ë°±ì—…ì€ `backup-phase09-20251031` ë¸Œëœì¹˜ì— ë³´ì¡´

---

### Part 2: RLS ë¬´í•œ ì¬ê·€ ë¬¸ì œ í•´ê²°

#### 2.1 ë¬¸ì œ ë¶„ì„

**ë¬´í•œ ì¬ê·€ ë°œìƒ ë©”ì»¤ë‹ˆì¦˜:**
```
1. Dashboard Layoutì—ì„œ users í…Œì´ë¸” SELECT ì‹œë„
   â†“
2. "HQ_Admin can view all users" ì •ì±… ì‹¤í–‰
   â†“
3. ì •ì±… ë‚´ì—ì„œ ë‹¤ì‹œ users í…Œì´ë¸” SELECT
   â†“
4. ë‹¤ì‹œ "HQ_Admin can view all users" ì •ì±… ì‹¤í–‰
   â†“
5. ë¬´í•œ ë°˜ë³µ...
```

#### 2.2 í•´ê²° ë°©ë²•: SECURITY DEFINER í•¨ìˆ˜ ì‚¬ìš©

**í•µì‹¬ ì•„ì´ë””ì–´:**
- RLS ì •ì±… ë‚´ì—ì„œ ì§ì ‘ users í…Œì´ë¸”ì„ ì¡°íšŒí•˜ì§€ ì•ŠìŒ
- ëŒ€ì‹  `SECURITY DEFINER` ê¶Œí•œì„ ê°€ì§„ í•¨ìˆ˜ë¥¼ í†µí•´ ì¡°íšŒ
- ì´ í•¨ìˆ˜ëŠ” RLSë¥¼ ìš°íšŒí•˜ë¯€ë¡œ ì¬ê·€ ë°œìƒí•˜ì§€ ì•ŠìŒ

**êµ¬í˜„:**

##### 2.2.1 Helper Function ìƒì„±
```sql
CREATE OR REPLACE FUNCTION public.get_current_user_role()
RETURNS TEXT
LANGUAGE plpgsql
SECURITY DEFINER  -- í•¨ìˆ˜ ì†Œìœ ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ (RLS ìš°íšŒ)
SET search_path = public
STABLE
AS $$
DECLARE
  user_role TEXT;
BEGIN
  -- RLS íŠ¸ë¦¬ê±° ì—†ì´ ì§ì ‘ ì¡°íšŒ
  SELECT role INTO user_role
  FROM public.users
  WHERE id = auth.uid();

  RETURN user_role;
END;
$$;
```

##### 2.2.2 RLS ì •ì±… ìˆ˜ì •
```sql
-- Before (ë¬´í•œ ì¬ê·€ ë°œìƒ):
CREATE POLICY "HQ_Admin can view all users"
  ON public.users
  FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM public.users
      WHERE id = auth.uid() AND role = 'HQ_Admin'
    )
  );

-- After (í•¨ìˆ˜ ì‚¬ìš©ìœ¼ë¡œ ì¬ê·€ í•´ê²°):
CREATE POLICY "HQ_Admin can view all users"
  ON public.users
  FOR SELECT
  USING (
    public.get_current_user_role() = 'HQ_Admin'
  );
```

##### 2.2.3 ëª¨ë“  HQ_Admin ì •ì±… ìˆ˜ì •
```sql
-- INSERT ì •ì±…
CREATE POLICY "HQ_Admin can insert users"
  ON public.users
  FOR INSERT
  WITH CHECK (
    public.get_current_user_role() = 'HQ_Admin'
  );

-- UPDATE ì •ì±…
CREATE POLICY "HQ_Admin can update users"
  ON public.users
  FOR UPDATE
  USING (
    public.get_current_user_role() = 'HQ_Admin'
  );
```

##### 2.2.4 ì¶”ê°€ ì •ì±…: ì‚¬ìš©ì ìì‹ ì˜ í”„ë¡œí•„ ì—…ë°ì´íŠ¸
```sql
-- ì‚¬ìš©ìê°€ ìì‹ ì˜ preferred_language ë“±ì„ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë„ë¡
CREATE POLICY "Users can update own profile"
  ON public.users
  FOR UPDATE
  USING (auth.uid() = id)
  WITH CHECK (auth.uid() = id);
```

#### 2.3 ìƒì„±ëœ íŒŒì¼

1. **`supabase/migrations/018_fix_users_rls_infinite_recursion.sql`**
   - ìƒˆë¡œìš´ migration íŒŒì¼
   - í”„ë¡œë•ì…˜ ì ìš©ìš© (ë‹¨ê³„ë³„ ì‹¤í–‰)

2. **`supabase/migrations/comprehensive_rebuild.sql`**
   - í†µí•© rebuild SQL ì—…ë°ì´íŠ¸
   - `get_current_user_role()` í•¨ìˆ˜ ì¶”ê°€
   - users í…Œì´ë¸” RLS ì •ì±… ìˆ˜ì •

---

## ğŸ“Š ë³€ê²½ ì‚¬í•­ ìš”ì•½

### Git ì»¤ë°‹ ì´ë ¥

```
8407ee7 â†’ 9565f2d (Hard Reset)
  - Phase 09ì˜ 8ê°œ ì»¤ë°‹ ì™„ì „ ì œê±°
  - backup-phase09-20251031 ë¸Œëœì¹˜ì— ë°±ì—…

9565f2d (í˜„ì¬ HEAD)
  - Fix: IntlProvider ë©”ì‹œì§€ ë³‘í•© êµ¬ì¡° ìˆ˜ì •
  - í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ i18n ì •ìƒ ì‘ë™ ìƒíƒœ

5ec0a65 (NEW)
  - Fix: users í…Œì´ë¸” RLS ë¬´í•œ ì¬ê·€ ë¬¸ì œ í•´ê²°
  - get_current_user_role() í•¨ìˆ˜ ì¶”ê°€
  - RLS ì •ì±… ìˆ˜ì •
```

### íŒŒì¼ ë³€ê²½ ë‚´ì—­

#### ì‚­ì œëœ íŒŒì¼:
- `app/[locale]/layout.tsx`
- `app/[locale]/page.tsx`
- `app/[locale]/(auth)/layout.tsx`
- `app/[locale]/(dashboard)/layout.tsx`
- ê¸°íƒ€ ëª¨ë“  `[locale]` í´ë” ë‚´ íŒŒì¼ë“¤

#### ë³µì›ëœ íŒŒì¼:
- `app/layout.tsx` - í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ êµ¬ì¡°
- `app/page.tsx` - locale prefix ì—†ìŒ
- `app/(auth)/login/page.tsx` - ì›ë˜ ìœ„ì¹˜
- `app/(dashboard)/layout.tsx` - ì›ë˜ ìœ„ì¹˜
- `lib/providers/intl-provider.tsx` - ë³µì›ë¨
- `middleware.ts` - Supabaseë§Œ ì²˜ë¦¬

#### ìƒˆë¡œ ìƒì„±ëœ íŒŒì¼:
- `supabase/migrations/018_fix_users_rls_infinite_recursion.sql`

#### ìˆ˜ì •ëœ íŒŒì¼:
- `supabase/migrations/comprehensive_rebuild.sql`
  - `get_current_user_role()` í•¨ìˆ˜ ì¶”ê°€ (ë¼ì¸ 80-99)
  - users í…Œì´ë¸” RLS ì •ì±… ìˆ˜ì • (ë¼ì¸ 511-540)

---

## âœ… í…ŒìŠ¤íŠ¸ ê²°ê³¼

### 1. ë¡œì»¬ ë¹Œë“œ í…ŒìŠ¤íŠ¸
```bash
npm run build
```

**ê²°ê³¼:**
- âœ… ë¹Œë“œ ì„±ê³µ
- âœ… 29ê°œ í˜ì´ì§€ ìƒì„±
- âœ… `/login`, `/dashboard` ë“± locale ì—†ëŠ” ê²½ë¡œ
- âš ï¸ ë¹Œë“œ ì‹œ next-intl ê²½ê³  (Phase 09 ì´ì „ì—ë„ ì¡´ì¬)

### 2. Supabase RLS ì •ì±… í…ŒìŠ¤íŠ¸

**Before (ë¬´í•œ ì¬ê·€):**
```sql
SELECT * FROM public.users WHERE id = auth.uid();
-- Error: infinite recursion detected
```

**After (ì •ìƒ ì‘ë™):**
```sql
SELECT * FROM public.users WHERE id = auth.uid();
-- Success: user data ë°˜í™˜
```

### 3. ë¡œê·¸ì¸ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ (ì˜ˆì •)

**ì˜ˆìƒ ë™ì‘:**
1. `/login` ì ‘ì†
2. ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
3. Supabase auth ì„±ê³µ
4. `app/(dashboard)/layout.tsx`ì—ì„œ user data ì¡°íšŒ
5. âœ… RLS ë¬´í•œ ì¬ê·€ ë°œìƒ ì•ˆ í•¨
6. âœ… user data ì •ìƒ ì¡°íšŒ
7. `/dashboard`ë¡œ redirect ì„±ê³µ

---

## ğŸ“ ë°°ìš´ ì  ë° ì¸ì‚¬ì´íŠ¸

### 1. Phase 09 ì‹¤íŒ¨ ì›ì¸ ë¶„ì„

**ì™œ ì‹¤íŒ¨í–ˆë‚˜?**

1. **ë³µì¡í•œ ì•„í‚¤í…ì²˜ ë³€ê²½:**
   - í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ â†’ ì„œë²„ ì‚¬ì´ë“œ ì „í™˜ì€ ë‹¨ìˆœí•œ ì½”ë“œ ì´ë™ì´ ì•„ë‹˜
   - Layout ì¤‘ì²© êµ¬ì¡°, middleware ì²´ì´ë‹, hydration ë“± ë³µì¡í•œ ì´ìŠˆ ë°œìƒ

2. **Next.js 14 App Router + next-intlì˜ ë¯¸ë¬˜í•œ ë™ì‘:**
   - `<html>`, `<body>` íƒœê·¸ ì¤‘ì²© ê¸ˆì§€
   - Server Component vs Client Component ê²½ê³„ ë¶ˆëª…í™•
   - Redirect ì²´ì´ë‹ ì‹œ ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘

3. **Production vs Development í™˜ê²½ ì°¨ì´:**
   - ë¡œì»¬ì—ì„œëŠ” ì¼ë¶€ ì‘ë™í•˜ì§€ë§Œ Productionì—ì„œ ì™„ì „ ì‹¤íŒ¨
   - Vercel í™˜ê²½ì—ì„œë§Œ ë‚˜íƒ€ë‚˜ëŠ” ë¬¸ì œë“¤

**êµí›ˆ:**
- âœ… í° ì•„í‚¤í…ì²˜ ë³€ê²½ì€ feature branchì—ì„œ ì¶©ë¶„íˆ í…ŒìŠ¤íŠ¸
- âœ… Production ë°°í¬ ì „ Preview í™˜ê²½ì—ì„œ ì² ì €íˆ ê²€ì¦
- âœ… ë¡¤ë°± ê³„íšì„ ë¯¸ë¦¬ ì„¸ì›Œë‘ê¸°
- âœ… ë°±ì—… ë¸Œëœì¹˜ëŠ” í•„ìˆ˜

### 2. RLS ë¬´í•œ ì¬ê·€ í•´ê²°ì˜ í•µì‹¬

**SECURITY DEFINERì˜ ì¤‘ìš”ì„±:**
- Postgres RLSëŠ” ê°•ë ¥í•˜ì§€ë§Œ, ì˜ëª» ì„¤ê³„í•˜ë©´ ë¬´í•œ ì¬ê·€ ë°œìƒ
- ì •ì±… ë‚´ì—ì„œ ê°™ì€ í…Œì´ë¸”ì„ ì¡°íšŒí•  ë•ŒëŠ” ë°˜ë“œì‹œ RLS ìš°íšŒ í•„ìš”
- `SECURITY DEFINER` í•¨ìˆ˜ê°€ ì´ë¥¼ ì•ˆì „í•˜ê²Œ í•´ê²°

**ì¢‹ì€ RLS ì„¤ê³„ íŒ¨í„´:**
```sql
-- Bad: ë¬´í•œ ì¬ê·€ ë°œìƒ
USING (EXISTS (SELECT 1 FROM same_table WHERE ...))

-- Good: Helper í•¨ìˆ˜ ì‚¬ìš©
USING (helper_function() = expected_value)
```

### 3. í´ë¼ì´ì–¸íŠ¸ vs ì„œë²„ ì‚¬ì´ë“œ i18n

**í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ (í˜„ì¬ ì‚¬ìš© ì¤‘):**
- âœ… êµ¬í˜„ì´ ë‹¨ìˆœí•¨
- âœ… ì–¸ì–´ ì „í™˜ì´ ë¹ ë¦„ (í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ë¶ˆí•„ìš”)
- âŒ ì²« ë¡œë”© ì‹œ ë²ˆì—­ íŒŒì¼ ë‹¤ìš´ë¡œë“œ í•„ìš”
- âŒ SEO ìµœì í™” ì–´ë ¤ì›€ (localeë³„ URL ì—†ìŒ)
- âš ï¸ Vercelì—ì„œ ENVIRONMENT_FALLBACK ê²½ê³  ë°œìƒ

**ì„œë²„ ì‚¬ì´ë“œ (ì‹œë„í–ˆìœ¼ë‚˜ ì‹¤íŒ¨):**
- âœ… SEO ìµœì í™” (localeë³„ URL: `/ko/dashboard`)
- âœ… ì„œë²„ ë Œë”ë§ìœ¼ë¡œ ì´ˆê¸° ë¡œë”© ë¹ ë¦„
- âŒ êµ¬í˜„ ë³µì¡ë„ ë§¤ìš° ë†’ìŒ
- âŒ Hydration ì—ëŸ¬ ë°œìƒ ê°€ëŠ¥ì„±
- âŒ ì–¸ì–´ ì „í™˜ ì‹œ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í•„ìš”

**ê²°ë¡ :**
- í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” ë‚´ë¶€ ê´€ë¦¬ ì‹œìŠ¤í…œì´ë¯€ë¡œ SEOê°€ ì¤‘ìš”í•˜ì§€ ì•ŠìŒ
- í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ i18nì´ ë” ì í•©
- ì„œë²„ ì‚¬ì´ë“œëŠ” ë‚˜ì¤‘ì— í•„ìš”í•  ë•Œ ì¬ê³ ë ¤

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

### 1. ì¦‰ì‹œ ìˆ˜í–‰ í•„ìš” (ê¸´ê¸‰)

**Supabase SQL Editorì—ì„œ ì‹¤í–‰:**
```sql
-- 018_fix_users_rls_infinite_recursion.sql ë‚´ìš© ì „ì²´ ì‹¤í–‰
-- ë˜ëŠ” comprehensive_rebuild.sql ì „ì²´ ì¬ì‹¤í–‰
```

**ì‹¤í–‰ í›„ í™•ì¸:**
1. Supabase Dashboard â†’ SQL Editor â†’ 018 migration ì‹¤í–‰
2. ë¡œì»¬ì—ì„œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
3. Productionì—ì„œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
4. Dashboard ì ‘ê·¼ í™•ì¸

### 2. Phase 09 ì¬ì‹œë„ ì—¬ë¶€ ê²°ì •

**í˜„ì¬ ìƒíƒœ:**
- í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ i18n ì •ìƒ ì‘ë™
- ë‹¤êµ­ì–´ ì§€ì› ì™„ë£Œ (en, ko, vi, zh)
- ì–¸ì–´ ì „í™˜ ì •ìƒ ì‘ë™
- âš ï¸ ë¹Œë“œ ì‹œ ê²½ê³  ìˆì§€ë§Œ production ì‘ë™

**ì¬ì‹œë„ ì¡°ê±´:**
- SEOê°€ ì •ë§ ì¤‘ìš”í•´ì§ˆ ë•Œ
- ë” ë§ì€ ì‹œê°„ê³¼ ë¦¬ì†ŒìŠ¤ í™•ë³´ ì‹œ
- Next.js 15 or next-intl ì—…ë°ì´íŠ¸ë¡œ êµ¬ì¡° ê°œì„  ì‹œ

**ë‹¹ë¶„ê°„ ê¶Œì¥ ì‚¬í•­:**
- âœ… í˜„ì¬ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ êµ¬ì¡° ìœ ì§€
- âœ… ë¹Œë“œ ê²½ê³  í•´ê²°ì— ì§‘ì¤‘
- âœ… ë‹¤ë¥¸ ê¸°ëŠ¥ ê°œë°œ ìš°ì„ 

### 3. ë‚¨ì€ ì‘ì—…

1. **ë¹Œë“œ ê²½ê³  í•´ê²° (ë‚®ì€ ìš°ì„ ìˆœìœ„):**
   ```
   ef [Error]: ENVIRONMENT_FALLBACK
   ef [Error]: MISSING_MESSAGE: auth.login (en)
   ```
   - ì´ ê²½ê³ ëŠ” Phase 09 ì´ì „ì—ë„ ì¡´ì¬
   - Production ì‘ë™ì— ì˜í–¥ ì—†ìŒ
   - ì‹œê°„ ì—¬ìœ  ì‹œ í•´ê²°

2. **ë‹¤ë¥¸ Phase ì‘ì—… ì§„í–‰:**
   - Phase 10: ì¶”ê°€ ê¸°ëŠ¥ ê°œë°œ
   - Phase 11: ì„±ëŠ¥ ìµœì í™”
   - Phase 12: í…ŒìŠ¤íŠ¸ ìë™í™”

---

## ğŸ“š ì°¸ê³  ìë£Œ

### Git ì»¤ë°‹ ì´ë ¥
- `backup-phase09-20251031` - Phase 09 ì „ì²´ ë°±ì—…
- `9565f2d` - ë¡¤ë°± ì§€ì  (Phase 09 ì´ì „)
- `5ec0a65` - RLS ë¬´í•œ ì¬ê·€ í•´ê²°

### ê´€ë ¨ ë¬¸ì„œ
- `docs/plans/009.phase09.i18n_ì„œë²„_ì‚¬ì´ë“œ_ì „í™˜_ê³„íš.md` - ì‹¤íŒ¨í•œ ê³„íšì„œ
- `docs/worklogs/011.phase09.ë‹¤êµ­ì–´_i18n_ì‹œìŠ¤í…œ_êµ¬í˜„.md` - ì„±ê³µí•œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ êµ¬í˜„

### Supabase ê´€ë ¨
- [Postgres RLS Best Practices](https://supabase.com/docs/guides/database/postgres/row-level-security)
- [SECURITY DEFINER Functions](https://www.postgresql.org/docs/current/sql-createfunction.html)

### Next.js + next-intl ê´€ë ¨
- [next-intl App Router Issues](https://github.com/amannn/next-intl/issues)
- [Next.js Hydration Errors](https://nextjs.org/docs/messages/react-hydration-error)

---

## ğŸ’¡ ê²°ë¡ 

### ì„±ê³µí•œ ê²ƒ:
- âœ… Phase 09 ì™„ì „ ë¡¤ë°± ì„±ê³µ
- âœ… ë°±ì—… ë¸Œëœì¹˜ ìƒì„±ìœ¼ë¡œ ì‘ì—… ë‚´ì—­ ë³´ì¡´
- âœ… RLS ë¬´í•œ ì¬ê·€ ë¬¸ì œ ê·¼ë³¸ ì›ì¸ íŒŒì•… ë° í•´ê²°
- âœ… í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ i18n êµ¬ì¡° ë³µì›
- âœ… Production ë°°í¬ ê°€ëŠ¥ ìƒíƒœ ë³µêµ¬

### ì‹¤íŒ¨í•œ ê²ƒ:
- âŒ Phase 09 ì„œë²„ ì‚¬ì´ë“œ i18n ì „í™˜
- âŒ React Hydration ì—ëŸ¬ í•´ê²° ì‹¤íŒ¨
- âŒ `/ko/dashboard` ê°™ì€ locale ê¸°ë°˜ URL êµ¬ì¡°

### ë°°ìš´ ê²ƒ:
- í° ì•„í‚¤í…ì²˜ ë³€ê²½ì€ ì¶©ë¶„í•œ ì‹œê°„ê³¼ í…ŒìŠ¤íŠ¸ í•„ìš”
- ë¡¤ë°± ê³„íšê³¼ ë°±ì—…ì€ í•„ìˆ˜
- RLS ì •ì±… ì„¤ê³„ ì‹œ ë¬´í•œ ì¬ê·€ ì£¼ì˜
- SECURITY DEFINER í•¨ìˆ˜ì˜ í™œìš©

### í˜„ì¬ ìƒíƒœ:
- âœ… í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ i18n ì •ìƒ ì‘ë™
- âœ… 4ê°œ ì–¸ì–´ ì§€ì› (en, ko, vi, zh)
- âœ… ì–¸ì–´ ì „í™˜ ê¸°ëŠ¥ ì •ìƒ
- âš ï¸ RLS ìˆ˜ì • SQLì„ Supabaseì— ì ìš© í•„ìš”
- âš ï¸ ë¡œê·¸ì¸ í›„ dashboard ì ‘ê·¼ í…ŒìŠ¤íŠ¸ í•„ìš”

---

**ì‘ì„±ì¼:** 2025-10-31
**ìµœì¢… ì—…ë°ì´íŠ¸:** 2025-10-31
**ìƒíƒœ:** ì™„ë£Œ (Supabase SQL ì ìš© ëŒ€ê¸° ì¤‘)
