# Phase 10: 반응형 모바일 UI 구현 계획

## 문서 정보
- **작성일:** 2025-11-03
- **Phase:** Phase 10
- **작업 범위:** 모바일/태블릿 반응형 UI 구현

## 프로젝트 현황

### 현재 상태
- **완료된 Phase:** Phase 09 (다국어 i18n 시스템 구현)
- **마지막 작업:** 네비게이션 크래시 및 i18n 오류 해결 (Worklog 013)
- **현재 UI 구조:**
  - Next.js 14 App Router + React 18
  - shadcn/ui + Tailwind CSS
  - 고정 사이드바 레이아웃 (256px)
  - 데스크톱 전용 디자인 (반응형 미지원)

### 해결해야 할 문제
1. **모바일/태블릿 환경에서 사이드바가 화면을 가림**
   - 현재: 고정 너비 256px 사이드바가 항상 표시
   - 작은 화면에서 콘텐츠 영역이 좁아지거나 가로 스크롤 발생

2. **반응형 디자인 부재**
   - 현재 코드베이스에서 반응형 클래스 사용이 매우 제한적 (27개 파일에서만 사용)
   - 대부분의 컴포넌트가 고정 크기/패딩 사용

3. **모바일 네비게이션 메커니즘 없음**
   - 사이드바를 열고 닫는 기능 없음
   - 햄버거 메뉴 없음

## 목표

### 주요 목표
1. **모바일 드로어 메뉴 구현**
   - 768px 이하에서 사이드바를 Sheet 드로어로 변환
   - 햄버거 메뉴 버튼으로 열기/닫기

2. **데스크톱 사이드바 접기 기능**
   - 768px 이상에서 선택적으로 사이드바 축소 가능
   - 축소 시 아이콘만 표시

3. **전체 반응형 UI 최적화**
   - 모든 페이지의 패딩, 간격, 그리드 레이아웃 반응형 조정
   - 테이블 가로 스크롤 처리
   - 터치 친화적 UI 요소

## 기술 사양

### 반응형 브레이크포인트
- **모바일:** `< 768px` (Tailwind `md:` 브레이크포인트)
- **태블릿:** `768px - 1024px` (md ~ lg)
- **데스크톱:** `≥ 1024px` (Tailwind `lg:`)

### 사이드바 동작 시나리오

#### 모바일 모드 (< 768px)
- **기본 상태:** 사이드바 숨김
- **모바일 헤더 표시:**
  - 햄버거 메뉴 버튼 (왼쪽)
  - 로고 (중앙)
  - 사용자 정보 (오른쪽)
- **사이드바 열기:** 햄버거 클릭 → Sheet 드로어 오버레이
- **사이드바 닫기:** 드로어 외부 클릭 또는 메뉴 항목 선택 시

#### 데스크톱 모드 (≥ 768px)
- **기본 상태:** 사이드바 표시 (256px 너비)
- **접기 기능:**
  - 사이드바 내부에 접기/펼치기 버튼
  - 접기 시: 아이콘만 표시 (80px 너비)
  - 펼치기 시: 전체 사이드바 복원 (256px 너비)
- **상태 저장:** localStorage에 접기/펼치기 상태 저장

### 애니메이션
- 전환 속도: 200-300ms
- Tailwind `transition-all duration-200 ease-in-out`
- Sheet 드로어: Radix UI 기본 애니메이션 사용

### 상태 관리
- React Context API 사용 (새로운 SidebarContext)
- localStorage로 사이드바 상태 영속성 유지
- 화면 크기 감지: `use-media-query` 커스텀 훅

## 구현 단계

### 1단계: 유틸리티 훅 생성

#### 1-1. 화면 크기 감지 훅 생성
**파일:** `hooks/use-media-query.ts`

**기능:**
- 현재 화면 너비가 특정 브레이크포인트를 만족하는지 확인
- SSR 안전하게 처리 (window 객체 체크)
- 리사이즈 이벤트 리스너 등록/해제

**API:**
```typescript
const isMobile = useMediaQuery('(max-width: 768px)')
const isDesktop = useMediaQuery('(min-width: 768px)')
```

#### 1-2. 사이드바 상태 관리 훅 생성
**파일:** `hooks/use-sidebar.ts`

**기능:**
- 사이드바 열기/닫기/토글 상태 관리
- localStorage에 상태 저장/불러오기
- Context Provider로 전역 상태 공유

**API:**
```typescript
const { isOpen, open, close, toggle } = useSidebar()
```

**Context:**
```typescript
<SidebarProvider>
  <App />
</SidebarProvider>
```

---

### 2단계: shadcn Sheet 컴포넌트 추가

#### 실행 명령
```bash
npx shadcn@latest add sheet
```

**생성되는 파일:**
- `components/ui/sheet.tsx`

**용도:**
- 모바일 드로어 메뉴로 사용
- Radix UI Dialog를 기반으로 한 슬라이드 패널
- 오버레이 배경 포함
- 접근성(a11y) 자동 처리

---

### 3단계: 모바일 헤더 컴포넌트 생성

#### 파일: `components/layout/mobile-header.tsx`

**구조:**
```
[햄버거 메뉴] [로고] [사용자 정보]
```

**기능:**
1. **햄버거 메뉴 버튼**
   - 아이콘: `lucide-react/Menu`
   - 클릭 시: `useSidebar().open()` 호출
   - 터치 영역: 최소 44x44px

2. **로고**
   - 중앙 정렬
   - "Arno Cosmetics" 텍스트 또는 로고 이미지

3. **사용자 정보**
   - 현재 로그인 사용자 이름 표시
   - 드롭다운 메뉴 (설정, 로그아웃)

**표시 조건:**
- `768px 미만`에서만 표시
- `md:hidden` 클래스 사용

**스타일:**
- 배경: `bg-white dark:bg-gray-800`
- 그림자: `shadow-sm`
- 높이: `h-16` (64px)
- 패딩: `px-4`

---

### 4단계: 사이드바 컴포넌트 개선

#### 파일: `components/layout/sidebar.tsx`

**현재 구조:**
```tsx
<aside className="w-64 bg-gray-900 text-white flex flex-col">
  <div className="p-4 h-16">로고</div>
  <nav className="flex-1">메뉴 항목들</nav>
  <div className="p-4">언어 전환기 + 사용자 정보 + 로그아웃</div>
</aside>
```

**개선 사항:**

##### 4-1. 데스크톱 모드 접기 기능
- **접기 버튼 추가:**
  - 위치: 사이드바 상단 또는 하단
  - 아이콘: `ChevronLeft` (펼쳐진 상태), `ChevronRight` (접힌 상태)

- **접힌 상태 스타일:**
  - 너비: `w-64` → `w-20` (256px → 80px)
  - 메뉴 텍스트 숨김: `overflow-hidden`
  - 아이콘만 표시 (중앙 정렬)
  - 툴팁 추가 (메뉴 이름 표시)

- **애니메이션:**
  ```tsx
  className={`transition-all duration-200 ${isCollapsed ? 'w-20' : 'w-64'}`}
  ```

##### 4-2. 모바일 모드 Sheet 드로어
- **Sheet 래핑:**
  ```tsx
  <Sheet open={isOpen} onOpenChange={setOpen}>
    <SheetContent side="left" className="w-64 p-0">
      {/* 기존 사이드바 내용 */}
    </SheetContent>
  </Sheet>
  ```

- **조건부 렌더링:**
  ```tsx
  {isMobile ? (
    <Sheet>...</Sheet>
  ) : (
    <aside>...</aside>
  )}
  ```

##### 4-3. 반응형 간격 조정
- 패딩: `p-4` → `p-3 md:p-4`
- 메뉴 항목 높이: `h-12` → `h-11 md:h-12`
- 폰트 크기: `text-base` → `text-sm md:text-base`

##### 4-4. 언어 전환기 최적화
- 모바일에서 전체 너비 사용
- Select 컴포넌트 터치 영역 확대

---

### 5단계: 대시보드 레이아웃 개선

#### 파일: `app/(dashboard)/layout.tsx`

**현재 구조:**
```tsx
<div className="flex h-screen overflow-hidden">
  <Sidebar />
  <main className="flex-1 overflow-y-auto p-8">
    {children}
  </main>
</div>
```

**개선된 구조:**

```tsx
<SidebarProvider>
  <div className="flex h-screen overflow-hidden">
    {/* 모바일 헤더 */}
    <MobileHeader className="md:hidden" />

    {/* 사이드바 */}
    <Sidebar />

    {/* 메인 콘텐츠 */}
    <main className="flex-1 overflow-y-auto">
      {/* 모바일 헤더 높이만큼 상단 여백 */}
      <div className="pt-16 md:pt-0 p-4 md:p-6 lg:p-8">
        {children}
      </div>
    </main>
  </div>
</SidebarProvider>
```

**변경 사항:**
1. `SidebarProvider`로 전체 래핑
2. `MobileHeader` 추가 (`md:hidden`)
3. 메인 콘텐츠 패딩 반응형 조정
4. 모바일에서 헤더 높이만큼 상단 여백 추가

---

### 6단계: 콘텐츠 영역 반응형 최적화

#### 대상 파일 (예시)
- `app/(dashboard)/dashboard/page.tsx`
- `app/(dashboard)/products/page.tsx`
- `app/(dashboard)/sales/page.tsx`
- `app/(dashboard)/inventory/page.tsx`
- `app/(dashboard)/reports/*/page.tsx`
- 기타 모든 대시보드 페이지 (30+ 페이지)

#### 공통 개선 패턴

##### 6-1. 페이지 헤더
**Before:**
```tsx
<h1 className="text-3xl font-bold mb-8">제목</h1>
```

**After:**
```tsx
<h1 className="text-2xl md:text-3xl font-bold mb-4 md:mb-8">제목</h1>
```

##### 6-2. 그리드 레이아웃
**Before:**
```tsx
<div className="grid grid-cols-2 gap-6">
```

**After:**
```tsx
<div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
```

##### 6-3. 테이블 스크롤
**Before:**
```tsx
<Table>...</Table>
```

**After:**
```tsx
<div className="overflow-x-auto -mx-4 md:mx-0">
  <div className="inline-block min-w-full align-middle">
    <Table>...</Table>
  </div>
</div>
```

##### 6-4. 버튼 그룹
**Before:**
```tsx
<div className="flex gap-4">
  <Button>버튼 1</Button>
  <Button>버튼 2</Button>
</div>
```

**After:**
```tsx
<div className="flex flex-col sm:flex-row gap-2 sm:gap-4">
  <Button className="w-full sm:w-auto">버튼 1</Button>
  <Button className="w-full sm:w-auto">버튼 2</Button>
</div>
```

##### 6-5. 폼 레이아웃
**Before:**
```tsx
<div className="grid grid-cols-2 gap-4">
  <Input />
  <Input />
</div>
```

**After:**
```tsx
<div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
  <Input />
  <Input />
</div>
```

##### 6-6. 카드 간격
**Before:**
```tsx
<Card className="p-6">
```

**After:**
```tsx
<Card className="p-4 md:p-6">
```

#### 우선순위 페이지
1. **Dashboard** - 사용 빈도 가장 높음
2. **Products, Sales, Inventory** - 주요 기능
3. **Reports** - 테이블 스크롤 처리 필수
4. **나머지 페이지** - 일괄 적용

---

### 7단계: 다국어 번역 추가

#### 대상 파일
- `locales/en/common.json`
- `locales/ko/common.json`
- `locales/vi/common.json`
- `locales/zh/common.json`

#### 추가 번역 키

```json
{
  "sidebar": {
    "toggle": "Toggle sidebar",
    "collapse": "Collapse sidebar",
    "expand": "Expand sidebar",
    "menu": "Menu"
  },
  "mobile": {
    "menu": "Menu",
    "closeMenu": "Close menu",
    "openMenu": "Open menu"
  }
}
```

#### 한국어 번역 (ko/common.json)
```json
{
  "sidebar": {
    "toggle": "사이드바 전환",
    "collapse": "사이드바 접기",
    "expand": "사이드바 펼치기",
    "menu": "메뉴"
  },
  "mobile": {
    "menu": "메뉴",
    "closeMenu": "메뉴 닫기",
    "openMenu": "메뉴 열기"
  }
}
```

#### 베트남어 번역 (vi/common.json)
```json
{
  "sidebar": {
    "toggle": "Chuyển đổi thanh bên",
    "collapse": "Thu gọn thanh bên",
    "expand": "Mở rộng thanh bên",
    "menu": "Menu"
  },
  "mobile": {
    "menu": "Menu",
    "closeMenu": "Đóng menu",
    "openMenu": "Mở menu"
  }
}
```

#### 중국어 번역 (zh/common.json)
```json
{
  "sidebar": {
    "toggle": "切换侧边栏",
    "collapse": "折叠侧边栏",
    "expand": "展开侧边栏",
    "menu": "菜单"
  },
  "mobile": {
    "menu": "菜单",
    "closeMenu": "关闭菜单",
    "openMenu": "打开菜单"
  }
}
```

---

### 8단계: 전체 테스트

#### 테스트 시나리오

##### 8-1. 모바일 환경 (< 768px)
- [ ] 페이지 로드 시 사이드바 숨김 확인
- [ ] 모바일 헤더 표시 확인
- [ ] 햄버거 메뉴 클릭 시 드로어 열림
- [ ] 메뉴 항목 선택 시 드로어 자동 닫힘
- [ ] 드로어 외부 클릭 시 닫힘
- [ ] 모든 페이지에서 가로 스크롤 없음
- [ ] 터치 영역이 충분히 큼 (44x44px)
- [ ] 테이블 가로 스크롤 작동

##### 8-2. 태블릿 환경 (768-1024px)
- [ ] 사이드바 기본 표시
- [ ] 접기 버튼 작동
- [ ] 콘텐츠 영역이 적절히 조정됨
- [ ] 그리드 레이아웃 2단 표시

##### 8-3. 데스크톱 환경 (≥ 1024px)
- [ ] 사이드바 기본 표시
- [ ] 접기 버튼 클릭 시 아이콘 모드로 축소
- [ ] 펼치기 버튼 클릭 시 전체 복원
- [ ] 상태가 localStorage에 저장됨
- [ ] 페이지 새로고침 후에도 상태 유지

##### 8-4. 다국어 테스트
- [ ] 모든 언어(en/ko/vi/zh)에서 사이드바 번역 확인
- [ ] 모바일 메뉴 번역 확인
- [ ] 툴팁 번역 확인

##### 8-5. 네비게이션 테스트
- [ ] 모든 메뉴 항목 클릭 가능
- [ ] 역할별 메뉴 필터링 작동 (HQ_Admin vs Branch_Manager)
- [ ] 언어 전환기 작동

##### 8-6. 페이지별 테스트 (30+ 페이지)
주요 페이지:
- [ ] Dashboard
- [ ] Locations
- [ ] Suppliers
- [ ] Products
- [ ] Purchase Orders (Create, List, Receive)
- [ ] Inventory (Stock, Transfer)
- [ ] Exchange Rates
- [ ] Pricing
- [ ] Sales
- [ ] Reports (Inventory, Sales, Transactions)

각 페이지에서:
- [ ] 모바일/태블릿/데스크톱 레이아웃 확인
- [ ] 폼 입력 가능
- [ ] 테이블 스크롤 확인
- [ ] 버튼 클릭 가능

---

## 기술적 고려사항

### 성능 최적화
1. **useMediaQuery 훅**
   - 디바운싱 적용 (리사이즈 이벤트)
   - 클린업 함수로 메모리 누수 방지

2. **애니메이션**
   - CSS 트랜지션 사용 (JS 애니메이션 회피)
   - `will-change` 속성으로 GPU 가속

3. **조건부 렌더링**
   - 불필요한 컴포넌트 마운트 방지
   - React.memo 적용 (필요시)

### 접근성 (a11y)
1. **키보드 네비게이션**
   - 햄버거 메뉴: Enter/Space로 열기
   - 드로어 닫기: ESC 키
   - 포커스 트랩 (드로어 열린 상태)

2. **스크린 리더**
   - `aria-label` 속성 추가
   - `aria-expanded` 상태 관리
   - 시맨틱 HTML 사용

3. **터치 영역**
   - 최소 44x44px (WCAG 기준)
   - 간격 충분히 확보

### 브라우저 호환성
- Chrome, Safari, Firefox, Edge 최신 버전
- iOS Safari 12+
- Android Chrome 90+

### SSR/CSR 고려사항
1. **서버 컴포넌트**
   - `app/(dashboard)/layout.tsx`는 서버 컴포넌트 유지
   - 클라이언트 컴포넌트 마킹 필요: `'use client'`

2. **Hydration 이슈**
   - `useMediaQuery`는 클라이언트에서만 실행
   - 초기 렌더링 시 `undefined` 처리
   - `useEffect`로 마운트 후 감지

---

## 예상 소요 시간

| 단계 | 작업 내용 | 예상 시간 |
|------|----------|-----------|
| 1 | 유틸리티 훅 생성 (use-media-query, use-sidebar) | 30분 |
| 2 | shadcn Sheet 컴포넌트 설치 | 5분 |
| 3 | 모바일 헤더 컴포넌트 생성 | 30분 |
| 4 | 사이드바 컴포넌트 개선 | 1시간 |
| 5 | 대시보드 레이아웃 수정 | 30분 |
| 6 | 콘텐츠 영역 반응형 최적화 (30+ 페이지) | 2시간 |
| 7 | 다국어 번역 추가 | 15분 |
| 8 | 전체 테스트 (시나리오별) | 30분 |

**총 예상 시간:** 약 5시간

---

## 성공 기준

### 필수 요구사항
- [x] 모바일(<768px)에서 햄버거 메뉴로 사이드바 열기/닫기 가능
- [x] 데스크톱(≥768px)에서 사이드바 접기/펼치기 가능
- [x] 모든 페이지가 모바일/태블릿에서 가로 스크롤 없이 표시
- [x] 테이블이 작은 화면에서 가로 스크롤 가능
- [x] 사이드바 상태가 localStorage에 저장되고 새로고침 후에도 유지
- [x] 다국어(en/ko/vi/zh) 지원 유지
- [x] 기존 기능 정상 작동 (회귀 없음)

### 사용자 경험 요구사항
- [x] 터치 영역 충분히 큼 (최소 44x44px)
- [x] 애니메이션이 부드러움 (200-300ms)
- [x] 드로어 열기/닫기가 직관적
- [x] 버튼/폼이 모바일에서 터치하기 쉬움
- [x] 콘텐츠가 읽기 쉽게 배치됨

### 기술 요구사항
- [x] SSR/CSR 안전하게 처리
- [x] 접근성(a11y) 기준 준수
- [x] 성능 저하 없음 (리렌더링 최소화)
- [x] TypeScript 타입 안전성 유지

---

## 위험 요소 및 대응 방안

### 위험 요소 1: SSR Hydration 불일치
**문제:**
- 서버와 클라이언트의 화면 크기 감지가 다를 수 있음
- `useMediaQuery`가 초기 렌더링 시 `undefined` 반환

**대응 방안:**
- `useState`와 `useEffect`로 클라이언트 마운트 후 감지
- 초기 상태는 기본값 사용 (예: 데스크톱 가정)
- `suppressHydrationWarning` 속성 사용 (필요시)

### 위험 요소 2: 기존 페이지 회귀
**문제:**
- 30+ 페이지의 반응형 수정 시 기존 레이아웃 깨질 수 있음

**대응 방안:**
- 단계별 수정 및 테스트
- 공통 패턴 먼저 적용 후 예외 처리
- Git 브랜치로 작업하고 충분한 테스트 후 머지

### 위험 요소 3: 성능 저하
**문제:**
- 리사이즈 이벤트 리스너가 너무 자주 실행됨

**대응 방안:**
- 디바운싱 또는 쓰로틀링 적용
- 필요한 컴포넌트에만 `useMediaQuery` 사용
- React.memo로 불필요한 리렌더링 방지

---

## 향후 확장 가능성

### Phase 11 이후 고려사항
1. **PWA (Progressive Web App)**
   - 오프라인 지원
   - 홈 화면에 추가
   - 푸시 알림

2. **모바일 제스처**
   - 스와이프로 사이드바 열기/닫기
   - Pull-to-refresh
   - 스와이프로 삭제

3. **다크 모드 토글**
   - 현재 다크 모드 설정은 있으나 UI 토글 없음
   - 모바일 헤더에 토글 버튼 추가

4. **모바일 앱 (React Native)**
   - 웹 버전 완성 후 네이티브 앱 개발
   - 코드 재사용 극대화

---

## 참고 자료

### Tailwind CSS 브레이크포인트
```
sm: 640px
md: 768px
lg: 1024px
xl: 1280px
2xl: 1536px
```

### shadcn/ui Sheet 컴포넌트
- 공식 문서: https://ui.shadcn.com/docs/components/sheet
- Radix UI Dialog 기반
- 사이드: left, right, top, bottom

### 반응형 디자인 베스트 프랙티스
- Mobile-first 접근 (작은 화면부터 설계)
- 터치 타겟 크기: 최소 44x44px (Apple HIG)
- 텍스트 크기: 최소 16px (iOS 자동 줌 방지)
- 가로 스크롤 피하기

---

## 체크리스트

### 시작 전 확인
- [ ] Git 브랜치 생성 (`feature/responsive-mobile-ui`)
- [ ] 현재 코드 커밋 및 푸시
- [ ] 개발 서버 실행 확인
- [ ] 브라우저 개발자 도구 준비 (디바이스 모드)

### 작업 중 확인
- [ ] 각 단계 완료 후 커밋
- [ ] 코드 린트 및 타입 체크
- [ ] 브라우저 콘솔 에러 확인
- [ ] 모바일/데스크톱 전환 테스트

### 완료 후 확인
- [ ] 모든 테스트 시나리오 통과
- [ ] 성능 저하 없음 확인
- [ ] 접근성 체크 (키보드 네비게이션)
- [ ] 다국어 번역 확인
- [ ] Git 커밋 및 푸시
- [ ] Worklog 작성

---

## 문서 이력
- 2025-11-03: 초안 작성
