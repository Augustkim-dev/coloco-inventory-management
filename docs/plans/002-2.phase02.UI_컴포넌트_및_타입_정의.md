# 002-2.phase02.UI 컴포넌트 및 타입 정의

**작업 단계**: Phase 02 - Step 2/3
**예상 소요 시간**: 1-2시간
**담당자**: 개발팀
**목표**: shadcn/ui 컴포넌트 설치, TypeScript 타입 정의, Toast 설정

---

## 1. 개요

마스터 데이터 CRUD UI 구현에 필요한 UI 컴포넌트를 설치하고, Supabase 데이터베이스 스키마에 맞는 TypeScript 타입을 정의합니다.

### 핵심 목표
- ✅ shadcn/ui 컴포넌트 5개 설치
- ✅ TypeScript 타입 정의 파일 생성
- ✅ Toast 알림 시스템 설정
- ✅ Select 컴포넌트 설정 (Unit, Category 선택용)

---

## 2. shadcn/ui 컴포넌트 설치

### 2.1 설치할 컴포넌트 목록

| 컴포넌트 | 용도 | 사용 위치 |
|---------|------|----------|
| **table** | 데이터 목록 표시 | Suppliers, Products, Locations 목록 |
| **textarea** | 긴 텍스트 입력 | Address, Notes, Description 필드 |
| **dialog** | 모달 다이얼로그 | 삭제 확인, 경고 메시지 |
| **select** | 드롭다운 선택 | Unit, Category, Location Type 선택 |
| **toast** | 알림 메시지 | 성공/실패 알림 |

### 2.2 설치 명령어

```bash
npx shadcn@latest add table
npx shadcn@latest add textarea
npx shadcn@latest add dialog
npx shadcn@latest add select
npx shadcn@latest add toast
```

### 2.3 생성될 파일

**UI 컴포넌트:**
- `components/ui/table.tsx`
- `components/ui/textarea.tsx`
- `components/ui/dialog.tsx`
- `components/ui/select.tsx`
- `components/ui/toast.tsx`
- `components/ui/toaster.tsx`
- `components/ui/use-toast.ts` (훅)

---

## 3. Toast 알림 시스템 설정

### 3.1 Toaster 컴포넌트 추가

**파일**: `app/layout.tsx`

```typescript
import { Toaster } from '@/components/ui/toaster'

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body>
        {children}
        <Toaster />  {/* 추가 */}
      </body>
    </html>
  )
}
```

### 3.2 Toast 사용 예시

```typescript
import { useToast } from '@/components/ui/use-toast'

function MyComponent() {
  const { toast } = useToast()

  const handleSuccess = () => {
    toast({
      title: "Success",
      description: "Supplier created successfully",
    })
  }

  const handleError = () => {
    toast({
      variant: "destructive",
      title: "Error",
      description: "Failed to create supplier",
    })
  }

  return <button onClick={handleSuccess}>Save</button>
}
```

---

## 4. TypeScript 타입 정의

### 4.1 데이터베이스 타입 생성 방법

#### 옵션 1: Supabase CLI 사용 (권장)

```bash
# Supabase CLI 설치
npm install -g supabase

# 로그인
supabase login

# 타입 생성
supabase gen types typescript --project-id YOUR_PROJECT_ID > types/database.ts
```

#### 옵션 2: 수동 타입 정의 (CLI 없이)

**파일**: `types/database.ts`

```typescript
export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export interface Database {
  public: {
    Tables: {
      locations: {
        Row: {
          id: string
          name: string
          location_type: 'HQ' | 'Branch'
          country_code: string
          currency: 'KRW' | 'VND' | 'CNY'
          address: string | null
          contact_person: string | null
          phone: string | null
          created_at: string
          updated_at: string
        }
        Insert: {
          id?: string
          name: string
          location_type: 'HQ' | 'Branch'
          country_code: string
          currency: 'KRW' | 'VND' | 'CNY'
          address?: string | null
          contact_person?: string | null
          phone?: string | null
          created_at?: string
          updated_at?: string
        }
        Update: {
          id?: string
          name?: string
          location_type?: 'HQ' | 'Branch'
          country_code?: string
          currency?: 'KRW' | 'VND' | 'CNY'
          address?: string | null
          contact_person?: string | null
          phone?: string | null
          created_at?: string
          updated_at?: string
        }
      }
      suppliers: {
        Row: {
          id: string
          name: string
          contact_person: string | null
          phone: string | null
          email: string | null
          address: string | null
          notes: string | null
          created_at: string
          updated_at: string
        }
        Insert: {
          id?: string
          name: string
          contact_person?: string | null
          phone?: string | null
          email?: string | null
          address?: string | null
          notes?: string | null
          created_at?: string
          updated_at?: string
        }
        Update: {
          id?: string
          name?: string
          contact_person?: string | null
          phone?: string | null
          email?: string | null
          address?: string | null
          notes?: string | null
          created_at?: string
          updated_at?: string
        }
      }
      products: {
        Row: {
          id: string
          sku: string
          name: string
          name_ko: string | null
          name_vn: string | null
          name_cn: string | null
          category: string | null
          unit: string
          shelf_life_days: number
          description: string | null
          created_at: string
          updated_at: string
        }
        Insert: {
          id?: string
          sku: string
          name: string
          name_ko?: string | null
          name_vn?: string | null
          name_cn?: string | null
          category?: string | null
          unit?: string
          shelf_life_days?: number
          description?: string | null
          created_at?: string
          updated_at?: string
        }
        Update: {
          id?: string
          sku?: string
          name?: string
          name_ko?: string | null
          name_vn?: string | null
          name_cn?: string | null
          category?: string | null
          unit?: string
          shelf_life_days?: number
          description?: string | null
          created_at?: string
          updated_at?: string
        }
      }
      // 나머지 테이블도 동일한 패턴으로 정의...
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      [_ in never]: never
    }
    Enums: {
      [_ in never]: never
    }
  }
}
```

### 4.2 기존 타입 확장

**파일**: `types/index.ts` (기존 파일 업데이트)

```typescript
import { Database } from './database'

// 기존 타입 유지
export type UserRole = 'HQ_Admin' | 'Branch_Manager'
export type LocationType = 'HQ' | 'Branch'
export type Currency = 'KRW' | 'VND' | 'CNY'
export type POStatus = 'Draft' | 'Approved' | 'Received'
export type QualityStatus = 'OK' | 'Damaged' | 'Quarantine'
export type Unit = 'EA' | 'BOX' | 'PACK'

// 데이터베이스 타입 별칭
export type Location = Database['public']['Tables']['locations']['Row']
export type Supplier = Database['public']['Tables']['suppliers']['Row']
export type Product = Database['public']['Tables']['products']['Row']

export type LocationInsert = Database['public']['Tables']['locations']['Insert']
export type SupplierInsert = Database['public']['Tables']['suppliers']['Insert']
export type ProductInsert = Database['public']['Tables']['products']['Insert']

export type LocationUpdate = Database['public']['Tables']['locations']['Update']
export type SupplierUpdate = Database['public']['Tables']['suppliers']['Update']
export type ProductUpdate = Database['public']['Tables']['products']['Update']

// 기존 인터페이스 유지
export interface User {
  id: string
  email: string
  name: string
  role: UserRole
  location_id: string | null
  created_at: string
  updated_at: string
}

export interface AuthError {
  message: string
  status?: number
}

export interface NavItem {
  title: string
  href: string
  icon?: any
  roles: UserRole[]
}
```

---

## 5. 상수 및 유틸리티 함수

### 5.1 제품 단위 상수

**파일**: `lib/constants.ts` (기존 파일에 추가)

```typescript
// 기존 내용 유지...

// 제품 단위 옵션
export const PRODUCT_UNITS = [
  { value: 'EA', label: 'EA (Each)' },
  { value: 'BOX', label: 'BOX' },
  { value: 'PACK', label: 'PACK' },
] as const

// 제품 카테고리 (예시)
export const PRODUCT_CATEGORIES = [
  { value: 'skincare', label: 'Skincare' },
  { value: 'makeup', label: 'Makeup' },
  { value: 'haircare', label: 'Haircare' },
  { value: 'bodycare', label: 'Bodycare' },
  { value: 'fragrance', label: 'Fragrance' },
] as const

// 통화 기호
export const CURRENCY_SYMBOLS: Record<Currency, string> = {
  KRW: '₩',
  VND: '₫',
  CNY: '¥',
}

// 지사 타입 옵션
export const LOCATION_TYPES = [
  { value: 'HQ', label: 'Headquarters' },
  { value: 'Branch', label: 'Branch' },
] as const

// 통화 옵션
export const CURRENCIES = [
  { value: 'KRW', label: 'KRW (₩)' },
  { value: 'VND', label: 'VND (₫)' },
  { value: 'CNY', label: 'CNY (¥)' },
] as const
```

### 5.2 포맷 유틸리티 함수

**파일**: `lib/utils.ts` (기존 파일에 추가)

```typescript
import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"
import { Currency } from '@/types'

// 기존 cn 함수 유지
export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

// 통화 포맷팅
export function formatCurrency(amount: number, currency: Currency): string {
  const symbols: Record<Currency, string> = {
    KRW: '₩',
    VND: '₫',
    CNY: '¥',
  }

  const decimals = currency === 'CNY' ? 2 : 0

  return `${symbols[currency]}${amount.toLocaleString('en-US', {
    minimumFractionDigits: decimals,
    maximumFractionDigits: decimals,
  })}`
}

// 날짜 포맷팅
export function formatDate(date: string | Date): string {
  const d = typeof date === 'string' ? new Date(date) : date
  return d.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  })
}

// SKU 유효성 검사
export function isValidSKU(sku: string): boolean {
  // SKU: 알파벳 대문자, 숫자, 하이픈만 허용
  return /^[A-Z0-9-]+$/.test(sku)
}
```

---

## 6. 설치 및 검증 순서

### 6.1 단계별 실행

```bash
# 1. shadcn/ui 컴포넌트 설치
npx shadcn@latest add table
npx shadcn@latest add textarea
npx shadcn@latest add dialog
npx shadcn@latest add select
npx shadcn@latest add toast

# 2. TypeScript 컴파일 확인
npx tsc --noEmit

# 3. Next.js 빌드 확인
npm run build
```

### 6.2 검증 체크리스트

**파일 생성 확인:**
- [ ] `components/ui/table.tsx` 생성
- [ ] `components/ui/textarea.tsx` 생성
- [ ] `components/ui/dialog.tsx` 생성
- [ ] `components/ui/select.tsx` 생성
- [ ] `components/ui/toast.tsx` 생성
- [ ] `components/ui/toaster.tsx` 생성
- [ ] `components/ui/use-toast.ts` 생성

**타입 정의 확인:**
- [ ] `types/database.ts` 생성 (또는 기존 types/index.ts 확장)
- [ ] TypeScript 컴파일 오류 없음

**기능 확인:**
- [ ] `app/layout.tsx`에 Toaster 추가
- [ ] `lib/constants.ts`에 상수 추가
- [ ] `lib/utils.ts`에 유틸리티 함수 추가

**빌드 확인:**
- [ ] `npm run build` 성공
- [ ] `npm run dev` 정상 실행

---

## 7. 컴포넌트 사용 예시

### 7.1 Table 컴포넌트

```typescript
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table'

<Table>
  <TableHeader>
    <TableRow>
      <TableHead>Name</TableHead>
      <TableHead>Email</TableHead>
      <TableHead>Actions</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    {data.map((item) => (
      <TableRow key={item.id}>
        <TableCell>{item.name}</TableCell>
        <TableCell>{item.email}</TableCell>
        <TableCell>...</TableCell>
      </TableRow>
    ))}
  </TableBody>
</Table>
```

### 7.2 Select 컴포넌트

```typescript
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select'

<Select value={unit} onValueChange={setUnit}>
  <SelectTrigger>
    <SelectValue placeholder="Select unit" />
  </SelectTrigger>
  <SelectContent>
    <SelectItem value="EA">EA (Each)</SelectItem>
    <SelectItem value="BOX">BOX</SelectItem>
    <SelectItem value="PACK">PACK</SelectItem>
  </SelectContent>
</Select>
```

### 7.3 Dialog 컴포넌트

```typescript
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog'

<Dialog open={open} onOpenChange={setOpen}>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Delete Supplier</DialogTitle>
      <DialogDescription>
        Are you sure you want to delete this supplier? This action cannot be undone.
      </DialogDescription>
    </DialogHeader>
    <DialogFooter>
      <Button variant="outline" onClick={() => setOpen(false)}>Cancel</Button>
      <Button variant="destructive" onClick={handleDelete}>Delete</Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

---

## 8. 완료 체크리스트

### 컴포넌트 설치
- [ ] table 컴포넌트 설치 완료
- [ ] textarea 컴포넌트 설치 완료
- [ ] dialog 컴포넌트 설치 완료
- [ ] select 컴포넌트 설치 완료
- [ ] toast 컴포넌트 설치 완료

### 타입 정의
- [ ] `types/database.ts` 생성 (또는 수동 타입 정의)
- [ ] `types/index.ts` 확장
- [ ] TypeScript 오류 없음

### 유틸리티 설정
- [ ] `app/layout.tsx`에 Toaster 추가
- [ ] `lib/constants.ts`에 상수 추가
- [ ] `lib/utils.ts`에 유틸리티 함수 추가

### 검증
- [ ] `npm run build` 성공
- [ ] TypeScript 컴파일 성공
- [ ] 개발 서버 정상 실행

---

## 9. 다음 단계

Step 2 완료 후 **002-3.phase02.마스터_데이터_CRUD_구현.md**로 진행합니다.

---

**작성자**: Claude Code
**작성일**: 2025-10-28
**다음 Step**: 002-3 (마스터 데이터 CRUD 구현)
